# åˆ†é¡µç³»ç»Ÿå’Œç”¨æˆ·ä½“éªŒæ”¹è¿›è¯´æ˜

## æ”¹è¿›æ¦‚è¿°

åŸºäºç”¨æˆ·åé¦ˆï¼Œæˆ‘ä»¬å®ç°äº†ä»¥ä¸‹é‡è¦æ”¹è¿›ï¼š

1. **UUIDè½¬æ¢ä¸ºç©å®¶å**: æ˜¾ç¤ºçœŸå®ç©å®¶åè€Œä¸æ˜¯UUID
2. **å•†åº—çŠ¶æ€æ˜¾ç¤º**: æ·»åŠ [å‡ºå”®]/[æ”¶è´­]/[åŒå‘]çŠ¶æ€æ ‡è¯†
3. **åˆ†é¡µç³»ç»Ÿ**: é¿å…ä¸€æ¬¡æ€§æ˜¾ç¤ºå¤§é‡å•†åº—ä¿¡æ¯
4. **å‘½ä»¤é‡æ„**: ä¼˜åŒ–å‘½ä»¤ç»“æ„å’Œç”¨æˆ·ä½“éªŒ

## è¯¦ç»†æ”¹è¿›å†…å®¹

### 1. UUIDåˆ°ç©å®¶åè½¬æ¢

**é—®é¢˜**: åŸæ¥æ˜¾ç¤ºçš„æ˜¯ç©å®¶UUIDï¼Œç”¨æˆ·ä½“éªŒå·®
```
é’»çŸ³ world (100, 64, 200) 50.00 123e4567-e89b-12d3-a456-426614174000
```

**è§£å†³æ–¹æ¡ˆ**: æ™ºèƒ½ç©å®¶åè·å–
```java
private String getPlayerName(UUID playerId, String cachedName) {
    // 1. ä¼˜å…ˆä½¿ç”¨ç¼“å­˜çš„åç§°ï¼ˆå¦‚æœä¸æ˜¯UUIDæ ¼å¼ï¼‰
    if (cachedName != null && !isUUID(cachedName)) {
        return cachedName;
    }
    
    // 2. å°è¯•ä»åœ¨çº¿ç©å®¶è·å–
    Player onlinePlayer = Bukkit.getPlayer(playerId);
    if (onlinePlayer != null) {
        return onlinePlayer.getName();
    }
    
    // 3. å°è¯•ä»ç¦»çº¿ç©å®¶è·å–
    OfflinePlayer offlinePlayer = Bukkit.getOfflinePlayer(playerId);
    String name = offlinePlayer.getName();
    if (name != null) {
        return name;
    }
    
    // 4. æœ€åè¿”å›UUIDç®€çŸ­å½¢å¼
    return playerId.toString().substring(0, 8) + "...";
}
```

**æ•ˆæœ**: ç°åœ¨æ˜¾ç¤ºçœŸå®ç©å®¶å
```
é’»çŸ³ world (100, 64, 200) 50.00 PlayerName [å‡ºå”®]
```

### 2. å•†åº—çŠ¶æ€æ˜¾ç¤º

**æ–°å¢åŠŸèƒ½**: åœ¨æ¯ä¸ªå•†åº—ä¿¡æ¯åæ˜¾ç¤ºçŠ¶æ€æ ‡è¯†

```java
private String getShopStatusText(ShopData.ShopType shopType) {
    switch (shopType) {
        case SELLING:
            return "&a[å‡ºå”®]";  // ç»¿è‰²
        case BUYING:
            return "&b[æ”¶è´­]";  // é’è‰²
        case BOTH:
            return "&e[åŒå‘]";  // é»„è‰²
        default:
            return "&7[æœªçŸ¥]";  // ç°è‰²
    }
}
```

**æ˜¾ç¤ºæ•ˆæœ**:
- `é’»çŸ³ world (100, 64, 200) 50.00 PlayerName [å‡ºå”®]`
- `é“é”­ world (150, 64, 250) 10.00 PlayerB [æ”¶è´­]`
- `é‡‘é”­ world (200, 64, 300) 25.00 PlayerC [åŒå‘]`

### 3. åˆ†é¡µç³»ç»Ÿå®ç°

**é—®é¢˜**: `/shoptools list`ä¸€æ¬¡æ€§æ˜¾ç¤º6000+å•†åº—ï¼Œé€ æˆï¼š
- èŠå¤©æ¡†è¢«åˆ·å±
- æœåŠ¡å™¨æ€§èƒ½å‹åŠ›
- ç”¨æˆ·æ— æ³•æœ‰æ•ˆæµè§ˆä¿¡æ¯

**è§£å†³æ–¹æ¡ˆ**: å®ç°åˆ†é¡µç³»ç»Ÿ

#### æ–°å‘½ä»¤ç»“æ„

**æ—§å‘½ä»¤**:
- `/shoptools list` - æ˜¾ç¤ºæ‰€æœ‰å•†åº—ï¼ˆé—®é¢˜ï¼‰
- `/shoptools list <ç‰©å“ID>` - æ˜¾ç¤ºç‰¹å®šç‰©å“å•†åº—

**æ–°å‘½ä»¤**:
- `/shoptools page <é¡µç >` - åˆ†é¡µæ˜¾ç¤ºæ‰€æœ‰å•†åº—
- `/shoptools list <ç‰©å“ID>` - æ˜¾ç¤ºç‰¹å®šç‰©å“å•†åº—ï¼ˆä¿æŒä¸å˜ï¼‰

#### åˆ†é¡µåŠŸèƒ½ç‰¹æ€§

**æ¯é¡µæ˜¾ç¤º**: 10ä¸ªå•†åº—
**é¡µç è®¡ç®—**: è‡ªåŠ¨è®¡ç®—æ€»é¡µæ•°
**å¯¼èˆªæç¤º**: æ˜¾ç¤ºä¸Šä¸€é¡µ/ä¸‹ä¸€é¡µå‘½ä»¤
**èŒƒå›´æ˜¾ç¤º**: æ˜¾ç¤ºå½“å‰é¡µçš„å•†åº—èŒƒå›´

**ç¤ºä¾‹è¾“å‡º**:
```
=== æ‰€æœ‰å•†åº— (ç¬¬1é¡µ/å…±672é¡µ) ===
è‹¹æœ world (100, 64, 200) 5.00 Alice [å‡ºå”®]
é’»çŸ³ world (150, 64, 250) 100.00 Bob [å‡ºå”®]
çŸ³å¤´ world (200, 64, 300) 1.00 Charlie [æ”¶è´­]
...ï¼ˆå…±10ä¸ªå•†åº—ï¼‰
æ˜¾ç¤ºç¬¬ 1-10 ä¸ªå•†åº—ï¼Œå…± 6717 ä¸ª
ä¸‹ä¸€é¡µ: /st page 2
```

#### åˆ†é¡µå®ç°ç»†èŠ‚

```java
private void displayShopListPaged(CommandSender sender, List<ShopData> shops, String title, int page) {
    int pageSize = 10;
    int totalPages = (int) Math.ceil((double) shops.size() / pageSize);
    
    // é¡µç éªŒè¯
    if (page > totalPages) {
        MessageUtil.sendMessage(sender, "&cé¡µç è¶…å‡ºèŒƒå›´ï¼æ€»å…± " + totalPages + " é¡µã€‚");
        return;
    }
    
    // è®¡ç®—æ˜¾ç¤ºèŒƒå›´
    int start = (page - 1) * pageSize;
    int end = Math.min(start + pageSize, shops.size());
    
    // æ˜¾ç¤ºå•†åº—ä¿¡æ¯...
    
    // å¯¼èˆªæç¤º
    if (page > 1) {
        navigation.append("ä¸Šä¸€é¡µ: &e/st page ").append(page - 1);
    }
    if (page < totalPages) {
        navigation.append("ä¸‹ä¸€é¡µ: &e/st page ").append(page + 1);
    }
}
```

### 4. Tabè¡¥å…¨å¢å¼º

**æ–°å¢è¡¥å…¨åŠŸèƒ½**:

1. **pageå‘½ä»¤è¡¥å…¨**: è‡ªåŠ¨è¡¥å…¨é¡µç ï¼ˆæ˜¾ç¤ºå‰10é¡µï¼‰
```java
if ("page".equals(subCommand)) {
    int totalShops = dataManager.getShopCount();
    int totalPages = (int) Math.ceil((double) totalShops / 10);
    for (int i = 1; i <= Math.min(totalPages, 10); i++) {
        completions.add(String.valueOf(i));
    }
}
```

2. **å‘½ä»¤é¡ºåºä¼˜åŒ–**: `page`å‘½ä»¤æ’åœ¨ç¬¬ä¸€ä½ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å¸¸ç”¨çš„

### 5. å¸®åŠ©ç³»ç»Ÿæ›´æ–°

**æ–°çš„å¸®åŠ©ä¿¡æ¯**:
```yaml
help-header: "&6=== ShopTools å¸®åŠ© ==="
help-page: "&e/shoptools page <é¡µç > &7- åˆ†é¡µæ˜¾ç¤ºæ‰€æœ‰å•†åº—"
help-list: "&e/shoptools list <ç‰©å“ID> &7- æ˜¾ç¤ºæŒ‡å®šç‰©å“çš„å•†åº—"
help-list-item: "&7åˆ«å: &e/st page <é¡µç >&7, &e/st list <ç‰©å“ID>"
help-who: "&e/shoptools who <ç©å®¶å> &7- æ˜¾ç¤ºæŒ‡å®šç©å®¶çš„å•†åº—"
help-reload: "&e/shoptools reload &7- é‡æ–°åŠ è½½é…ç½®å’Œæ•°æ®"
```

### 6. é”™è¯¯å¤„ç†å’Œç”¨æˆ·å¼•å¯¼

**æ™ºèƒ½æç¤º**: å½“ç”¨æˆ·ä½¿ç”¨æ—§å‘½ä»¤æ—¶ï¼Œæä¾›æ–°å‘½ä»¤æç¤º
```java
if (args.length < 2) {
    MessageUtil.sendMessage(sender, "&cç”¨æ³•: /shoptools list <ç‰©å“ID>");
    MessageUtil.sendMessage(sender, "&eæç¤º: ä½¿ç”¨ /shoptools page <é¡µç > æŸ¥çœ‹æ‰€æœ‰å•†åº—");
    return;
}
```

**é¡µç éªŒè¯**: å®Œå–„çš„é¡µç èŒƒå›´æ£€æŸ¥
```java
if (page > totalPages) {
    MessageUtil.sendMessage(sender, "&cé¡µç è¶…å‡ºèŒƒå›´ï¼æ€»å…± " + totalPages + " é¡µã€‚");
    return;
}
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- åˆ†é¡µæ˜¾ç¤ºé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ–‡æœ¬åˆ°èŠå¤©æ¡†
- å‡å°‘å®¢æˆ·ç«¯å†…å­˜å‹åŠ›

### 2. æœåŠ¡å™¨æ€§èƒ½ä¼˜åŒ–
- é¿å…ä¸€æ¬¡æ€§å‘é€å¤§é‡æ¶ˆæ¯åŒ…
- å‡å°‘ç½‘ç»œå¸¦å®½å ç”¨

### 3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- ä¿¡æ¯åˆ†é¡µä¾¿äºæµè§ˆ
- æ™ºèƒ½ç©å®¶åæ˜¾ç¤ºæé«˜å¯è¯»æ€§
- çŠ¶æ€æ ‡è¯†ä¸€ç›®äº†ç„¶

## ä½¿ç”¨ç¤ºä¾‹

### æµè§ˆæ‰€æœ‰å•†åº—
```
ç©å®¶: /st page 1
ç³»ç»Ÿ: === æ‰€æœ‰å•†åº— (ç¬¬1é¡µ/å…±672é¡µ) ===
      è‹¹æœ world (100, 64, 200) 5.00 Alice [å‡ºå”®]
      é’»çŸ³ world (150, 64, 250) 100.00 Bob [å‡ºå”®]
      ...
      ä¸‹ä¸€é¡µ: /st page 2

ç©å®¶: /st page 2
ç³»ç»Ÿ: === æ‰€æœ‰å•†åº— (ç¬¬2é¡µ/å…±672é¡µ) ===
      ...
      ä¸Šä¸€é¡µ: /st page 1  ä¸‹ä¸€é¡µ: /st page 3
```

### æŸ¥æ‰¾ç‰¹å®šç‰©å“
```
ç©å®¶: /st list DIAMOND
ç³»ç»Ÿ: === ç‰©å“ DIAMOND çš„å•†åº— ===
      é’»çŸ³ world (100, 64, 200) 50.00 Alice [å‡ºå”®]
      é’»çŸ³ world (150, 70, 300) 55.00 Bob [å‡ºå”®]
      é’»çŸ³ world (200, 65, 400) 60.00 Charlie [æ”¶è´­]
      === å…± 3 ä¸ªå•†åº— ===
```

## é…ç½®æ›´æ–°

**æ¶ˆæ¯æ ¼å¼æ›´æ–°**:
```yaml
shop-list-item: "&e{item} &7{location} &a{price} &b{owner} {status}"
```

æ–°å¢äº†`{status}`å ä½ç¬¦ç”¨äºæ˜¾ç¤ºå•†åº—çŠ¶æ€ã€‚

## éƒ¨ç½²è¯´æ˜

è¿™äº›æ”¹è¿›å®Œå…¨å‘åå…¼å®¹ï¼š
- âœ… ç°æœ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨å‡çº§
- âœ… æ—§å‘½ä»¤ä»ç„¶å¯ç”¨ï¼ˆå¸¦æç¤ºï¼‰
- âœ… ä¸å½±å“ç°æœ‰æ•°æ®

ç”¨æˆ·å¯ä»¥ç«‹å³äº«å—åˆ°ï¼š
- ğŸ¯ æ›´æ¸…æ™°çš„å•†åº—ä¿¡æ¯æ˜¾ç¤º
- ğŸ“„ ä¾¿äºæµè§ˆçš„åˆ†é¡µç³»ç»Ÿ
- ğŸš€ æ›´å¥½çš„æœåŠ¡å™¨æ€§èƒ½
- ğŸ’¡ æ™ºèƒ½çš„ç”¨æˆ·å¼•å¯¼
